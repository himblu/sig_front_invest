<style>
  .list-group-item  {
    border: 1px solid #ccc !important;
  }
</style>
<div class="animated fadeIn fast">
  <div class="form-row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <i class="fa fa-file mr-1"></i>Información de Archivos
        </div>
        <div class="card-body text-center" *ngIf="!files.length">
          <i class="fa fa-times fa-2x"></i><br>
          No se tiene configurado ningún archivo para la inscripción.
        </div>
        <div class="card-body" *ngIf="files.length">
          <div class="form-row">
            <div class="col-12" *ngIf="isInserted">
              <div class="alert alert-success">
                <i class="fa fa-check mr-1"></i>Se ha finalizado el proceso de <strong class="text-uppercase">Registro de Datos</strong> correctamente. Por favor espere la <strong class="text-uppercase">Validación de Documentos</strong> de las Áreas correspondientes (en un plazo máximo de 48 horas). Por favor revise su correo electrónico.
              </div>
            </div>
            <div class="col-12" *ngIf="isRegularizing">
              <div class="alert alert-info">
                <i class="fa fa-exclamation-triangle mr-1"></i>Estas en proceso de <strong>Regularización de Documentos</strong>. Verifica bien las imagenes, documentos y datos ingresados, para no volver a ser <strong>OBSERVADO</strong>.
              </div>
            </div>
            <div class="col-5">
              <ul class="list-group">
                <li class="list-group-item hand" [ngClass]="{'list-group-item-success': fileSelected && fileSelected.fileProcessConfigID === f.fileProcessConfigID}" *ngFor="let f of files" (click)="toggleSelectFile(f)">
                  <div class="form-row">
                    <div class="col-9">
                      <i class="fa fa-file mr-1"></i>{{f.fileTypeName}} <br>
                    </div>
                    <div class="col-3 text-right">
                      <span class="text-secondary" *ngIf="!f.hasFile">
                        (Click para Subir)
                      </span>
                      <small *ngIf="f.hasFile">
                        <span *ngIf="!f.error">
                          <i class="fa fa-circle text-success mr-1"></i>Completado
                        </span>
                        <span *ngIf="f.error">
                          <i class="fa fa-times text-danger mr-1"></i>Error
                        </span>
                      </small>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
            <div class="col-7" *ngIf="fileSelected">
              <div class="card">
                <div class="card-body">
                  <div class="form-row">
                    <div class="col-6 mb-3">
                      <label *ngIf="!fileSelected.hasFile" for="file-{{fileSelected.fileProcessConfigID}}" class="btn btn-sm btn-custom">Elegir {{fileSelected.executableTypeID === 1 ? 'Imagen' : 'Archivo'}}</label>
                      <input type="file" accept="{{fileSelected.accept}}" id="file-{{fileSelected.fileProcessConfigID}}" [(ngModel)]="fileSelected.file" style="visibility: none; width: 0px !important;" (change)="changeFile($event, fileSelected)" name="userPhoto">
                    </div>
                    <div class="col-6 mb-3 text-right">
                      <button class="btn btn-sm btn-danger" *ngIf="((fileSelected.hasFile && !isInserted) || (fileSelected.hasFile && isRegularizing)) && !isInserted" (click)="resetFile(fileSelected)">
                        <i class="fa fa-trash mr-1"></i>Quitar Archivo
                      </button>
                    </div>
                    <div class="col-7 visualizer-file" >
                      <div class="card" *ngIf="fileSelected.hasFile">
                        <div class="card-header">
                          <i class="fa fa-file mr-1"></i>Visualización del Archivo
                        </div>
                        <div class="card-body p-1 text-center">
                          <img [src]="fileSelected.url ? fileSelected.url : 'assets/images/current-user.png'" *ngIf="fileSelected.executableTypeID === 1" class="rounded-circle" alt="{{fileSelected.fileName}}" width="250" height="250">
                          <pdf-viewer
                            *ngIf="fileSelected.executableTypeID !== 1" 
                            [src]="fileSelected.url"
                            [render-text]="true"
                            [original-size]="false"
                            style="width: 100%; height: 400px"
                          ></pdf-viewer>
                        </div>
                      </div>
                    </div>
                    <!-- fileSelected.executableTypeID !== 1 &&  -->
                    <div class="col-5" >
                      <div class="card mb-3" *ngIf="fileSelected.statusFileID === 4">
                        <div class="card-header">
                          <i class="fa fa-building mr-1"></i>Información de Validación de Documentos
                        </div>
                        <div class="card-body">
                          <small><strong>Observación</strong></small><br>
                          <i class="fa fa-comment mr-1"></i>{{(fileSelected.commentary || '-') | uppercase}}
                        </div>
                      </div>
                      <div class="form-row" *ngIf="fileSelected.hasFile">
                        <ng-container *ngIf="fileSelected.fileTypeID === 13">
                          <div class="col-12">
                            <div class="card">
                              <div class="card-header" [ngClass]="{'bg-danger text-white': fileSelected.error}">
                                <i class="fa fa-money mr-1"></i>Información sobre el Pago
                              </div>
                              <div class="card-body p-1">
                                <form [formGroup]="financialForm">
                                  <div class="form-row">
                                    <div class="col-12">
                                      <label for="financialEntity">Entidad Financiera</label>
                                      <select (change)="validateVoucher()" formControlName="financialEntity" id="" class="form-control">
                                        <option value="">--SELECCIONE ENTIDAD--</option>
                                        <option *ngFor="let o of financialEntities" [ngValue]="o.financialEntityID">{{o.financialEntityDesc}}</option>
                                      </select>
                                    </div>
                                    <div class="col-12">
                                      <label for="transactionType">Tipo de Transacción</label>
                                      <select (change)="validateVoucher()" formControlName="transactionType" id="" class="form-control">
                                        <option value="">--SELECCIONE TIPO--</option>
                                        <option *ngFor="let o of transactionTypes" [ngValue]="o.transactionTypeID">{{o.transactionTypeDesc}}</option>
                                      </select>
                                    </div>
                                    <div class="col-6">
                                      <label for="voucherNumber">Número de Voucher</label>
                                      <input type="text" formControlName="voucherNumber" class="form-control">
                                    </div>
                                    <div class="col-6">
                                      <label for="payDay">Fecha de Pago</label>
                                      <input type="date" formControlName="payDay" (change)="validateVoucher()" [max]="currentDate" class="form-control">
                                    </div>
                                    <div class="col-12 mt-2">
                                      <mat-form-field class="width" appearance="outline">
                                        <mat-label>Monto</mat-label>
                                        <input type="text" disabled value="{{fileSelected.amount}}" matInput>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </form>
                              </div>
                            </div>
                          </div>
                        </ng-container>
                        
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12"></div>
            <div class="col-6 mt-4">
              <a class="btn btn-sm btn-light text-primary-color" *ngIf="!isRegularizing" [routerLink]="['../../informacion-academica', userId]">
                Volver
              </a>
            </div>
            <div class="col-6 mt-4 text-right">
              <button class="btn btn-sm bg-primary-color" *ngIf="isRegularizing" (click)="toggleRegularizing()">
                <i class="fa fa-save mr-1"></i>Regularizar documentación
              </button>
              <button class="btn btn-sm bg-primary-color" *ngIf="!isRegularizing && !isInserted && fileType" (click)="toggleRegularizing()">
                <i class="fa fa-save mr-1"></i>Actualizar Información de Pagos
              </button>
              <button class="btn btn-sm bg-primary-color" *ngIf="!isRegularizing && !isInserted && !fileType" (click)="toggleValidationModal()">
                <i class="fa fa-save mr-1"></i>Crear Inscripción
              </button>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div>


<div bsModal #validationEnrollModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="dialog-sizes-name2">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <div class="form-row">
          <div class="col-8">
            <h4 id="dialog-sizes-name2" class="modal-title pull-left">
              Resumen de Inscripción de Postulante
            </h4>
          </div>
          <div class="col-4 text-right">
            <button type="button" class="btn btn-light text-danger" aria-label="Close" (click)="toggleValidationModal()">
              <span aria-hidden="true"><i class="fa fa-times"></i></span>
            </button>
          </div>
          <div class="col-12">
            <div class="alert alert-light">
              <i class="fa fa-info mr-1"></i>Estimado postulante, esta información fue registrado en todo el proceso de <strong>INSCRIPCIÓN</strong>, favor de validarla y si es correcta <strong>TERMINE LA INSCRIPCIÓN</strong>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-body" style="max-height: 450px !important; overflow: auto;">
        <div class="form-row">
          <div class="col-12">
            <div class="card mb-2">
              <div class="card-header bg-primary-color text-white">
                <i class="fa fa-user mr-1"></i>Información Personal
              </div>
              <div class="card-body">
                <div class="form-row">

                  <div class="col-12">
                    <strong>Nombre Completo</strong> <br>
                    {{(personalInfo.fullName || '-') | uppercase}}
                  </div>
                  
                  <div class="col-6">
                    <strong>Tipo de Documento</strong><br>
                    {{(personalInfo.typeDocName || '-') | uppercase}}
                  </div>
                  <div class="col-6">
                    <strong>Número de Documento</strong><br>
                    {{personalInfo.identity || '-'}}
                  </div>

                  <div class="col-3">
                    <strong>Estado Civil</strong><br>
                    {{(personalInfo.civilStatusDesc || '-') | uppercase}}
                  </div>
                  <div class="col-3">
                    <strong>Género</strong><br>
                    {{(personalInfo.genderDesc || '-') | uppercase}}
                  </div>
                  <div class="col-3">
                    <strong>Sexo</strong><br>
                    {{(personalInfo.sexDesc || '-') | uppercase}}
                  </div>

                  <div class="col-3">
                    <strong>Tipo de Sangre</strong><br>
                    {{(personalInfo.bloodTypeDesc || '-') | uppercase}}
                  </div>

                  <div class="col-4">
                    <strong>Nacionalidad</strong><br>
                    {{(personalInfo.nationality || '-') | uppercase}}
                  </div>
                  <div class="col-4">
                    <strong>País</strong><br>
                    {{(personalInfo.countryName || '-') | uppercase}}
                  </div>
                  <div class="col-4">
                    <strong>Fecha de Nacimiento</strong><br>
                    {{personalInfo.birthDate | date: 'dd/MM/yyyy'}}
                  </div>
                  <ng-container *ngIf="personalInfo.countryID === 59">
                    <div class="col-4">
                      <strong>Provincia</strong><br>
                      {{(personalInfo.provinceName || '-') | uppercase}}
                    </div>
                    <div class="col-4">
                      <strong>Cantón</strong><br>
                      {{(personalInfo.cantonName || '-') | uppercase}}
                    </div>
                  </ng-container>
                  <div class="col-4">
                    <strong>Grupo Cultural</strong><br>
                    {{(personalInfo.EthnicityDesc || '-') | uppercase}} 
                    <span *ngIf="personalInfo.ethnicityID === 1">
                      <br>
                      <strong>Pueblo Nacionalidad</strong><br>
                      ({{(personalInfo.parishname || '-') | uppercase}})
                    </span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header bg-primary-color text-white">
                <i class="fa fa-user mr-1"></i>Información Académica
              </div>
              <div class="card-body" *ngIf="academicInfo">
                <div class="form-row">
                  <div class="col-4">
                    <strong>Sede de Inscripción</strong><br>
                    {{(academicInfo.branchDesc || '-') | uppercase}} 
                  </div>
                  <div class="col-4">
                    <strong>Modalidad</strong><br>
                    {{(academicInfo.modalityDesc || '-') | uppercase}} 
                  </div>
                  <div class="col-4">
                    <strong>Carrera Profesional</strong><br>
                    {{(academicInfo.careerDesc || '-') | uppercase}} 
                  </div>

                  <div class="col-6">
                    <strong>Tipo de colegio</strong><br>
                    {{(academicInfo.collegeTypeName || '-') | uppercase}} 
                  </div>
                  <div class="col-6">
                    <strong>Nombre de Colegio</strong><br>
                    {{(academicInfo.collegeName || '-') | uppercase}} 
                  </div>

                  <div class="col-12">
                    <strong>Título Bachiller</strong><br>
                    {{(academicInfo.degreeTitle || '-') | uppercase}} 
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-row">
          <div class="col-12 mb-2">
            <mat-checkbox color="primary" name="accept" [(ngModel)]="accept">
              Aceptar la información registrada para <strong>TERMINAR LA INSCRIPCIÓN</strong>.
            </mat-checkbox>
          </div>
          <div class="col-6">
            <button class="btn btn-sm btn-danger" (click)="toggleValidationModal()">
              <i class="fa fa-times mr-1"></i>Cancelar
            </button>
          </div>
          <div class="col-6 text-right">
            <button class="btn btn-sm bg-primary-color" [disabled]="saving" (click)="saveEnroll()">
              <i class="fa fa-save mr-1"></i>Terminar la Inscripción
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div bsModal #instructionModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="dialog-sizes-name2">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" *ngIf="showModal">
      <div class="modal-body" style="height: 600px; overflow: auto;">
        <div class="form-row">
          <div class="col-9 pt-1">
            <!-- <span *ngIf="fileType">Instrucciones para Pago de Inscripciones</span>
            <span *ngIf="!fileType">Instrucciones para Adjuntar Archivos</span> -->
          </div>
          <div class="col-3 text-right">
            <button type="button" class="btn btn-sm btn-light text-danger" aria-label="Close" (click)="toggleInstructions()">
              <span aria-hidden="true"><i class="fa fa-times mr-1"></i>Cerrar</span>
            </button>
          </div>
          <div class="col-12 mt-3 text-center">
            <ng-container *ngIf="isInserted">
              <img src="assets/images/final.jpeg" alt="comprobantes" width="100%">
            </ng-container>
            <ng-container *ngIf="!isInserted">
              <ng-container *ngIf="fileType">
                <iframe width="100%" *ngIf="showVideo" style="height: 500px;" src="assets/videos/pago_inscripcion.mp4" title="PAGO DE INSCRIPCIÓN" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture;" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                <img src="assets/images/comprobantes.png" *ngIf="!showVideo" alt="comprobantes" width="100%">          
              </ng-container>
              <iframe width="100%" style="height: 500px;" *ngIf="!fileType" src="assets/videos/etapa_2_inscripcion_adjuntar_archivos.mp4" title="INSCRIPCIÓN ADJUNTAR ARCHIVOS" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture;" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>