<div class="container-fluid">
  <div class="row mt-4">
    <div class="col-10">
      <div [style.width]="(periods.length * 182) + 358 + 'px'" class="mat-elevation-z8 curriculum-container">
        <div class="curriculum-header">
          <div class="curriculum-organization-unit-header border-left-1 border-top-1 h-100">
            <div>
              <span>UNIDADES DE ORGANIZACIÓN CURRICULAR</span>
            </div>
          </div>

          <div class="learning-activities-header border-left-1 border-top-1 h-100">
            <div>
              <span>ACTIVIDADES DE APRENDIZAJE</span>
            </div>
          </div>

          <div class="period-header border-left-1 border-top-1 h-100" [style.width]="182 * (periods.length + 1)"
               *ngFor="let period of periods; trackBy: trackByPeriod;">
            <div>
              <div class="period-name-header">
                <div class="period-name">
                  <span>{{ period.name }}</span>
                </div>
              </div>
              <div class="period-subject-header">
                <div class="period-subject-name-header border-top-1">
                  <span>MATERIA</span>
                </div>
                <div class="period-subject-hours-header border-left-1 border-top-1">
                  <span>HORAS</span>
                </div>
              </div>
            </div>
          </div>

          <div class="period-hours-header border-left-1 border-top-1 border-right-1 h-100">
            <div>
              <span>TOTAL HORAS</span>
            </div>
          </div>
        </div>

        <!--BODY-->
        <div>
          <div class="unit-container" style="display: flex;"
               *ngFor="let unit of curriculum.units; let indexUnit = index;">
            <div class="border-left-1 border-top-1" style="width: 150px; min-width: 150px;">
              <div class="input-container pr-2 pl-2"
                   style="display: flex; align-items: center; justify-content: center; min-height: 60px; height: 100%; align-self: center;">
                {{ unit.name }}
              </div>
            </div>


            <div style="display: block;">
              <div style="display: flex;" *ngFor="let row of unit.rows; let indexRow = index">
                <div class="learning-activities-container border-left-1 border-top-1">
                  <div class="learning-activity">
                    <div class="pl-2 pr-2">
                      <span>Contacto Con Docente</span>
                    </div>
                  </div>
                  <div class="learning-activity border-top-1">
                    <div class="pl-2 pr-2">
                      <span>Práctico - Experimental</span>
                    </div>
                  </div>
                  <div class="learning-activity border-top-1">
                    <div class="pl-2 pr-2">
                      <span>Autónomo</span>
                    </div>
                  </div>
                  <div class="learning-activity border-top-1">
                    <div class="pl-2 pr-2" style="color: black;">
                      <span>CRÉDITOS / HORAS</span>
                    </div>
                  </div>
                </div>

                <div
                  style="width: 182px; height: 120px;" class="subject-container"
                  *ngFor="let period of periods; let indexSingleRow = index; trackBy: trackByPeriod;">
                    <ng-container
                            [ngTemplateOutletContext]="{ indexSingleRow: indexSingleRow, subject: row[indexSingleRow] }"
                            [ngTemplateOutlet]="row[indexSingleRow]?.courseID !== 0 ? hasData : isEmpty">
                    </ng-container>
                  <ng-template #hasData let-subject="subject" let-indexSingleRow="indexSingleRow" let-indexUnit="indexUnit">
<!--                    <div matRipple [style.background-color]="subject.background" [style.color]="subject.color">-->
                    <div matRipple>
                      <div
                        style="height: 90px; display: flex" class="border-left-1 border-top-1">
                        <div style="width: 114px; display: block;">
                          <div style="height: 20px; display: flex; justify-content: space-between;">
                            <div style="overflow: auto;">
                              <div style="height: 20px; display: flex;">
                                <div
                                  *ngFor="let dependency of subject.depends;"
                                  [style.background]="dependency.background"
                                  [style.color]="dependency.color"
                                  [matTooltip]="dependency.name"
                                  matTooltipPosition="above"
                                  style="cursor: pointer; border-radius: 2px; height: 15px; width: 15px; border: 1px solid white; margin: 2px 0 0 2px;">
                                </div>
                                <div
                                  *ngFor="let dependency of subject.depends;"
                                  [matTooltip]="dependency.name"
                                  matTooltipPosition="above"
                                  style="cursor: pointer; border-radius: 2px; height: 15px; width: 15px; border: 1px solid white; margin: 2px 0 0 2px;">
                                </div>
                              </div>
                            </div>
                          </div>
                          <div
                            class="text-uppercase"
                            style="font-size: 12px; user-select: none; text-align: center; height: 70px; display: flex; justify-content: center; align-items: center;">
                            {{ subject.courseName }}
                          </div>
                        </div>
                        <div style="width: 69px;">
                          <div class="input-container border-left-1">
                            {{ subject.faceToFaceHours }}
                          </div>
                          <div class="input-container border-left-1 border-top-1">
                            {{ subject.experimentalHours }}
                          </div>
                          <div class="input-container border-left-1 border-top-1">
                            {{ subject.unsupervisedHours }}
                          </div>
                        </div>
                      </div>
                      <div style="height: 30px; display: flex;" class="border-left-1 border-top-1">
                        <div
                          [style.color]="'black'"
                          style="width: 113px; padding: 2px; text-align: center; align-self: center;">
                            {{ subject.credits | number: '':'en-US' }}
                        </div>
                        <div
                          class="border-left-1"
                          [style.color]="'black'"
                          style="width: 69px; padding: 2px; text-align: center; align-self: center;">
                            {{ (subject | hoursPerSubject) | number: '':'en-US' }}
                        </div>
                      </div>
                    </div>
                  </ng-template>

                  <ng-template #isEmpty let-indexSingleRow="indexSingleRow" let-indexUnit="indexUnit">
                    <div class="border-left-1 border-top-1"
                         style="cursor: default; width: 100%;" matRipple>
                      <div style="height: 120px; display: flex; justify-content: center; align-items: center;">
                      </div>
                    </div>
                  </ng-template>
                </div>
              </div>
            </div>

            <div class="border-left-1 border-top-1 border-right-1"
                 style="width: 58px; display: flex; align-items: center; justify-content: center;">
              <div>
                <span>{{ (unit.rows | hoursPerUnit) | number: '':'en-US' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

